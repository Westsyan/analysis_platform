@(projectName: Seq[String], proname: String)(implicit session: Session)
@background.main("")(projectName) {

    <style>
            label {
                text-indent: 2em;
            }

            .indent {
                margin-left: 4em;
                margin-bottom: 10px;
            }

            .indent-1 {
                margin-left: 6em;
                margin-bottom: 10px;
            }

            .indent-2 {
                margin-left: 2em;
                margin-bottom: 10px;
            }
    </style>

    <div class="page-content-wrapper">

        <div class="page-content">

            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li>
                        <i class="fa fa-tachometer"></i>
                        <a href="#">@proname - 导入数据</a>
                    </li>
                </ul>
            </div>


            <div class="row-fluid">

                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="portlet blue-soft box">

                            <div class="portlet-title">
                                <div class="caption">
                                    数据处理
                                </div>
                            </div>

                            <div class="portlet-body">

                                <form class="registration-form form-horizontal" id="UpdateForm"
                                accept-charset="UTF-8">

                                    <div class="form-group">
                                        <h4 class="col-sm-12">选择文件</h4>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-12">样品名:</label>
                                        <div class="col-sm-6 indent">
                                            <input name="sample" id="sample" class="form-control" />
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label class="col-sm-12">fastq 1 文件:</label>
                                        <div class="col-sm-6 indent">
                                            <input id="input-1" type="file" class="file" name="file1" data-show-preview="false"
                                            data-show-upload="false">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-12">fastq 2 文件:</label>
                                        <div class=" col-sm-6 indent">
                                            <input id="input-2" type="file" class="file" name="file2" data-show-preview="false"
                                            data-show-upload="false">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <h4 class="col-sm-12">参数设置:</h4>
                                    </div>

                                    <div class="form-group">
                                        <h5 style="margin-left: 2em;">Trimmomatic PE(paired-end) - 1
                                            <a id="down-1" style="margin-left: 2em">
                                                <i class="fa fa-arrow-down"></i>
                                            </a>
                                            <a id="up-1" style="margin-left: 2em;
                                                display: none">
                                                <i class="fa fa-arrow-up"></i>
                                            </a>
                                        </h5>
                                    </div>

                                    <div id="set-1" style="display: none">

                                        <div class="form-group">
                                            <label class="col-sm-12">
                                                Input FASTQ quality file scores encoding type:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="encondingType">
                                                    <option value="-phred64">Illumina 1.3-1.7 Phred+64</option>
                                                    <option value="-phred33" selected>Illumina 1.8+ Phred+33</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">Perform initial ILLUMINACLIP step?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="stepMethod" onchange="stepChange(this)">
                                                    <option value="yes" selected>Yes</option>
                                                    <option value="no">No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="stepValue">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">Adapter sequences to use:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <select class="form-control" name="adapter">
                                                        <option value="TruSeq2-PE.fa">
                                                            TruSeq2 (paired-ended, for Illumina GAII)</option>
                                                        <option value="TruSeq3-PE.fa">
                                                            TruSeq3 (paired-ended, for MiSeq and HiSeq)</option>
                                                        <option value="TruSeq3-PE-2.fa">
                                                            TruSeq3 (additional seqs) (paired-ended, for MiSeq and HiSeq)</option>
                                                        <option value="NexteraPE-PE.fa">Nextera (paired-ended)</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Maximum mismatch count which will still allow a full match to be performed:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="seed_mismatches" id="seed_mismatches" class="form-control" value="2" />
                                                </div>
                                            </div>

                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    How accurate the match between the two 'adapter ligated' reads must be for PE palin
                                                    drome read alignment:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="palindrome_clip_threshold" id="palindrome_clip_threshold" class="form-control" value="30" />
                                                </div>
                                            </div>

                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    How accurate the match between any adapter etc. sequence must be against a read:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="simple_clip_threshold" id="simple_clip_threshold" class="form-control" value="10" />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">Perform Sliding window trimming (SLIDINGWINDOW)?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="trimMethod" onchange="trimChange(this)">
                                                    <option value="yes" selected>Yes</option>
                                                    <option value="no">No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="trimValue">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Number of bases to average across:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="window_size" id="window_size" class="form-control" value="50" />
                                                </div>
                                            </div>

                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Average quality required:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="required_quality" id="required_quality" class="form-control" value="20" />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">Drop reads below a specified length (MINLEN)?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="minlenMethod" onchange="minlenChange(this)">
                                                    <option value="yes" selected>Yes</option>
                                                    <option value="no">No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="minlenValue">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Minimum length of reads to be kept:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="minlen" id="minlen" class="form-control" value="50" />
                                                </div>
                                            </div>

                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">
                                                Cut bases off the start of a read, if below a threshold quality (LEADING)?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="leadingMethod" onchange="leadingChange(this)">
                                                    <option value="yes">Yes</option>
                                                    <option value="no" selected>No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="leadingValue" style="display: none">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Minimum quality required to keep a base:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="leading" id="leading" class="form-control" value="3" />
                                                </div>
                                            </div>

                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">
                                                Cut bases off the end of a read, if below a threshold quality (TRAILING)?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="trailingMethod" onchange="trailingChange(this)">
                                                    <option value="yes" selected>Yes</option>
                                                    <option value="no">No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="trailingValue">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Minimum quality required to keep a base:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="trailing" id="trailing" class="form-control" value="3" />
                                                </div>
                                            </div>

                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">Cut the read to a specified length (CROP):</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="cropMethod" onchange="cropChange(this)">
                                                    <option value="yes">Yes</option>
                                                    <option value="no" selected>No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="cropValue" style="display: none">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Number of bases to keep from the start of the read:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="crop" id="crop" class="form-control" value="" />
                                                </div>
                                            </div>

                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-12">
                                                Cut the specified number of bases from the start of the read (HEADCROP)?:</label>
                                            <div class="col-sm-6 indent">
                                                <select class="form-control" name="headcropMethod" onchange="headcropChange(this)">
                                                    <option value="yes">Yes</option>
                                                    <option value="no" selected>No</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="headcropValue" style="display: none">
                                            <div class="form-group" >
                                                <label class="col-sm-12 indent-2">
                                                    Number of bases to remove from the start of the read:</label>
                                                <div class="col-sm-6 indent-1">
                                                    <input name="headcrop" id="headcrop" class="form-control" value="" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <h5 style="margin-left: 2em;">Using FLASH to merge paired-end reads
                                            <a id="down-2" style="margin-left: 2em">
                                                <i class="fa fa-arrow-down"></i>
                                            </a>
                                            <a id="up-2" style="margin-left: 2em;
                                                display: none">
                                                <i class="fa fa-arrow-up"></i>
                                            </a>
                                        </h5>
                                    </div>



                                    <div id="set-2" style="display: none">
                                        <div class="form-group" >
                                            <label class="col-sm-12">
                                                The minimum required overlap length between two reads to provide a confident overlap. Default:10bp.</label>
                                            <div class="col-sm-6 indent">
                                                <input name="m" id="m" class="form-control" value="10" />
                                            </div>
                                        </div>

                                        <div class="form-group" >
                                            <label class="col-sm-12">
                                                Maximum overlap length expected in approximately 90% of read pairs. It is by default set to 65bp, which works well for 100bp reads generated from a 180bp library, assuming a normal distribution of fragment lengths.</label>
                                            <div class="col-sm-6 indent">
                                                <input name="M" id="M" class="form-control" value="65" />
                                            </div>
                                        </div>

                                        <div class="form-group" >
                                            <label class="col-sm-12">
                                                Maximum allowed ratio between the number of mismatched base pairs and the overlap length. Default: 0.25.</label>
                                            <div class="col-sm-6 indent">
                                                <input name="x" id="x" class="form-control" value="0.25" />
                                            </div>
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <div class = "actions col-sm-offset-1 col-sm-4">
                                            <button type="button" class="btn btn-primary" style="width: 90%;" id="search" onclick="Running()">
                                                应用</button>
                                        </div>
                                    </div>
                                </form>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>

            $("#down-1").click(function () {
                $("#set-1").show()
                $("#down-1").hide()
                $("#up-1").show()
            })

            $("#up-1").click(function () {
                $("#set-1").hide()
                $("#down-1").show()
                $("#up-1").hide()
            })

            $("#down-2").click(function () {
                $("#set-2").show()
                $("#down-2").hide()
                $("#up-2").show()
            })

            $("#up-2").click(function () {
                $("#set-2").hide()
                $("#down-2").show()
                $("#up-2").hide()
            })

            function stepChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#stepValue").show()
                } else {
                    $("#stepValue").hide()
                }
            }

            function trimChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#trimValue").show()
                } else {
                    $("#trimValue").hide()
                }
            }

            function minlenChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#minlenValue").show()
                } else {
                    $("#minlenValue").hide()
                }
            }

            function leadingChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#leadingValue").show()
                } else {
                    $("#leadingValue").hide()
                }
            }

            function trailingChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#trailingValue").show()
                } else {
                    $("#trailingValue").hide()
                }
            }

            function cropChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#cropValue").show()
                } else {
                    $("#cropValue").hide()
                }
            }

            function headcropChange(element) {
                var value = $(element).find(">option:selected").val()
                if (value == "yes") {
                    $("#headcropValue").show()
                } else {
                    $("#headcropValue").hide()
                }
            }

            function Running() {
                var form = new FormData($("#UpdateForm")[0]);
                $.ajax({
                    url: "/project/update?proname=@proname",
                    type: "post",
                    dataType: "json",
                    processData: false,
                    contentType: false,
                    data: form,
                    success: function (data) {
                        if(data.valid == "false") {
                            swal({
                                title: "错误!",
                                text: data.message,
                                type: "error",
                                confirmButtonText: "确定"
                            })
                        }else{
                            swal("")
                        }
                    }
                });
            }


            $("#input-1").fileinput({
                showPreview: false,
                browseLabel: "选择文件"
            });

            $("#input-2").fileinput({
                showPreview: false,
                browseLabel: "选择文件"
            });
    </script>
}